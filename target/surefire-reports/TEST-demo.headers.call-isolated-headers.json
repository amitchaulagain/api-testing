[
  {
    "line": 1,
    "elements": [
      {
        "line": 5,
        "name": "",
        "description": "",
        "type": "background",
        "keyword": "Background",
        "steps": [
          {
            "result": {
              "duration": 12345057,
              "status": "passed"
            },
            "comments": [
              {
                "line": 6,
                "value": "# note how this next line has to be duplicated in \u0027common-multiple.feature\u0027"
              }
            ],
            "line": 7,
            "name": "configure headers \u003d read(\u0027classpath:headers.js\u0027)",
            "match": {
              "arguments": [
                {
                  "val": "headers",
                  "offset": 10
                },
                {
                  "val": "read(\u0027classpath:headers.js\u0027)",
                  "offset": 20
                }
              ],
              "location": "StepDefs.configure(String,String)"
            },
            "keyword": "* "
          },
          {
            "result": {
              "duration": 0,
              "status": "passed"
            },
            "line": 0,
            "name": "call [common routine that updates the configured headers and cookies] common-multiple.feature",
            "match": {},
            "keyword": "* "
          },
          {
            "result": {
              "duration": 0,
              "status": "passed"
            },
            "line": 6,
            "name": "url demoBaseUrl",
            "match": {
              "arguments": [
                {
                  "val": "demoBaseUrl",
                  "offset": 4
                }
              ],
              "location": "StepDefs.url(String)"
            },
            "keyword": "Given "
          },
          {
            "result": {
              "duration": 0,
              "status": "passed"
            },
            "line": 7,
            "name": "path \u0027headers\u0027",
            "match": {
              "arguments": [
                {
                  "val": "\u0027headers\u0027",
                  "offset": 5
                }
              ],
              "location": "StepDefs.path(String\u003e)"
            },
            "keyword": "And "
          },
          {
            "result": {
              "duration": 0,
              "status": "passed"
            },
            "line": 8,
            "name": "method get",
            "match": {
              "arguments": [
                {
                  "val": "get",
                  "offset": 7
                }
              ],
              "location": "StepDefs.method(String)"
            },
            "keyword": "When ",
            "doc_string": {
              "content_type": "",
              "line": 8,
              "value": "13:17:33.659 karate.get failed for expression: \u0027token\u0027: javascript evaluation failed: token, ReferenceError: \"token\" is not defined in \u003ceval\u003e at line number 1\n13:17:33.661 karate.get failed for expression: \u0027time\u0027: javascript evaluation failed: time, ReferenceError: \"time\" is not defined in \u003ceval\u003e at line number 1\n13:17:33.662 request:\n1 \u003e GET http://127.0.0.1:58351/headers\n1 \u003e Accept-Encoding: gzip,deflate\n1 \u003e Connection: Keep-Alive\n1 \u003e Host: 127.0.0.1:58351\n1 \u003e User-Agent: Apache-HttpClient/4.5.5 (Java/1.8.0_162)\n\n13:17:33.668 response time in milliseconds: 5\n1 \u003c 200\n1 \u003c Cache-Control: no-cache, no-store, max-age\u003d0, must-revalidate\n1 \u003c Content-Length: 36\n1 \u003c Content-Type: text/plain;charset\u003dUTF-8\n1 \u003c Date: Thu, 20 Sep 2018 07:32:33 GMT\n1 \u003c Expires: 0\n1 \u003c Pragma: no-cache\n1 \u003c Set-Cookie: time\u003d1537428753666\n1 \u003c X-Content-Type-Options: nosniff\n1 \u003c X-Frame-Options: DENY\n1 \u003c X-XSS-Protection: 1; mode\u003dblock\nc7355b63-23a6-4e39-a1d2-741f31d5139f\n\n"
            }
          },
          {
            "result": {
              "duration": 0,
              "status": "passed"
            },
            "line": 9,
            "name": "status 200",
            "match": {
              "arguments": [
                {
                  "val": "200",
                  "offset": 7
                }
              ],
              "location": "StepDefs.status(int)"
            },
            "keyword": "Then "
          },
          {
            "result": {
              "duration": 0,
              "status": "passed"
            },
            "comments": [
              {
                "line": 11,
                "value": "# this is the line that has to be duplicated in the \u0027caller\u0027 feature"
              }
            ],
            "line": 12,
            "name": "configure headers \u003d read(\u0027classpath:headers.js\u0027)",
            "match": {
              "arguments": [
                {
                  "val": "headers",
                  "offset": 10
                },
                {
                  "val": "read(\u0027classpath:headers.js\u0027)",
                  "offset": 20
                }
              ],
              "location": "StepDefs.configure(String,String)"
            },
            "keyword": "* "
          },
          {
            "result": {
              "duration": 0,
              "status": "passed"
            },
            "comments": [
              {
                "line": 14,
                "value": "# and these variables need to be \u0027unpacked\u0027 by the \u0027caller\u0027 as well"
              }
            ],
            "line": 15,
            "name": "def time \u003d responseCookies.time.value",
            "match": {
              "arguments": [
                {
                  "val": "time",
                  "offset": 4
                },
                {
                  "val": "responseCookies.time.value",
                  "offset": 11
                }
              ],
              "location": "StepDefs.def(String,String)"
            },
            "keyword": "* "
          },
          {
            "result": {
              "duration": 0,
              "status": "passed"
            },
            "line": 16,
            "name": "def token \u003d response",
            "match": {
              "arguments": [
                {
                  "val": "token",
                  "offset": 4
                },
                {
                  "val": "response",
                  "offset": 12
                }
              ],
              "location": "StepDefs.def(String,String)"
            },
            "keyword": "* "
          },
          {
            "result": {
              "duration": 0,
              "status": "passed"
            },
            "comments": [
              {
                "line": 18,
                "value": "# all because we are not using \u0027shared scope\u0027"
              },
              {
                "line": 19,
                "value": "# and this second API call depends on the \u0027headers.js\u0027 configured above"
              }
            ],
            "line": 20,
            "name": "path \u0027headers\u0027, token",
            "match": {
              "arguments": [
                {
                  "val": "\u0027headers\u0027, token",
                  "offset": 5
                }
              ],
              "location": "StepDefs.path(String\u003e)"
            },
            "keyword": "Given "
          },
          {
            "result": {
              "duration": 0,
              "status": "passed"
            },
            "line": 21,
            "name": "param url \u003d demoBaseUrl",
            "match": {
              "arguments": [
                {
                  "val": "url",
                  "offset": 6
                },
                {
                  "val": "demoBaseUrl",
                  "offset": 12
                }
              ],
              "location": "StepDefs.param(String,String\u003e)"
            },
            "keyword": "And "
          },
          {
            "result": {
              "duration": 0,
              "status": "passed"
            },
            "line": 22,
            "name": "method get",
            "match": {
              "arguments": [
                {
                  "val": "get",
                  "offset": 7
                }
              ],
              "location": "StepDefs.method(String)"
            },
            "keyword": "When ",
            "doc_string": {
              "content_type": "",
              "line": 22,
              "value": "13:17:33.679 request:\n2 \u003e GET http://127.0.0.1:58351/headers/c7355b63-23a6-4e39-a1d2-741f31d5139f?url\u003dhttp%3A%2F%2F127.0.0.1%3A58351\n2 \u003e Accept-Encoding: gzip,deflate\n2 \u003e Authorization: c7355b63-23a6-4e39-a1d2-741f31d5139f1537428753666http://127.0.0.1:58351\n2 \u003e Connection: Keep-Alive\n2 \u003e Cookie: time\u003d1537428753666\n2 \u003e Host: 127.0.0.1:58351\n2 \u003e User-Agent: Apache-HttpClient/4.5.5 (Java/1.8.0_162)\n2 \u003e request_id: 152225c7-26ea-4250-af0a-bb1c40070ebd\n\n13:17:33.682 response time in milliseconds: 2\n2 \u003c 200\n2 \u003c Cache-Control: no-cache, no-store, max-age\u003d0, must-revalidate\n2 \u003c Content-Length: 0\n2 \u003c Date: Thu, 20 Sep 2018 07:32:33 GMT\n2 \u003c Expires: 0\n2 \u003c Pragma: no-cache\n2 \u003c X-Content-Type-Options: nosniff\n2 \u003c X-Frame-Options: DENY\n2 \u003c X-XSS-Protection: 1; mode\u003dblock\n\n"
            }
          },
          {
            "result": {
              "duration": 0,
              "status": "passed"
            },
            "line": 23,
            "name": "status 200",
            "match": {
              "arguments": [
                {
                  "val": "200",
                  "offset": 7
                }
              ],
              "location": "StepDefs.status(int)"
            },
            "keyword": "Then "
          },
          {
            "result": {
              "duration": 307534606,
              "status": "passed"
            },
            "line": 9,
            "name": "def setup \u003d callonce read(\u0027common-multiple.feature\u0027)",
            "match": {
              "arguments": [
                {
                  "val": "setup",
                  "offset": 4
                },
                {
                  "val": "callonce read(\u0027common-multiple.feature\u0027)",
                  "offset": 12
                }
              ],
              "location": "StepDefs.def(String,String)"
            },
            "keyword": "* ",
            "doc_string": {
              "content_type": "",
              "line": 9,
              "value": "13:17:33.683 cached callonce: read(\u0027common-multiple.feature\u0027)\n"
            }
          },
          {
            "result": {
              "duration": 2402689,
              "status": "passed"
            },
            "comments": [
              {
                "line": 10,
                "value": "# and we have to ensure the \u0027time\u0027 and \u0027token\u0027 variables are set for \u0027headers.js\u0027 to work"
              }
            ],
            "line": 11,
            "name": "def time \u003d setup.time",
            "match": {
              "arguments": [
                {
                  "val": "time",
                  "offset": 4
                },
                {
                  "val": "setup.time",
                  "offset": 11
                }
              ],
              "location": "StepDefs.def(String,String)"
            },
            "keyword": "* "
          },
          {
            "result": {
              "duration": 290031,
              "status": "passed"
            },
            "line": 12,
            "name": "def token \u003d setup.token",
            "match": {
              "arguments": [
                {
                  "val": "token",
                  "offset": 4
                },
                {
                  "val": "setup.token",
                  "offset": 12
                }
              ],
              "location": "StepDefs.def(String,String)"
            },
            "keyword": "* "
          },
          {
            "result": {
              "duration": 164907,
              "status": "passed"
            },
            "comments": [
              {
                "line": 14,
                "value": "# a cookie is also needed in our authentication demo example"
              }
            ],
            "line": 15,
            "name": "cookie time \u003d setup.time",
            "match": {
              "arguments": [
                {
                  "val": "time",
                  "offset": 7
                },
                {
                  "val": "setup.time",
                  "offset": 14
                }
              ],
              "location": "StepDefs.cookie(String,String)"
            },
            "keyword": "* "
          },
          {
            "result": {
              "duration": 27995,
              "status": "passed"
            },
            "comments": [
              {
                "line": 17,
                "value": "# for an example of using \u0027shared scope\u0027 which simplifies the above"
              },
              {
                "line": 18,
                "value": "# refer to \u0027call-updates-config.feature\u0027 and \u0027common.feature\u0027"
              }
            ],
            "line": 20,
            "name": "url demoBaseUrl",
            "match": {
              "arguments": [
                {
                  "val": "demoBaseUrl",
                  "offset": 4
                }
              ],
              "location": "StepDefs.url(String)"
            },
            "keyword": "* "
          }
        ]
      },
      {
        "line": 22,
        "name": "all auth headers have been set via the background and \u0027common-multiple.feature\u0027",
        "description": "",
        "id": "when-not-using-\u0027shared-scope\u0027,-\u0027configure-headers\u0027-may-need-to-be;all-auth-headers-have-been-set-via-the-background-and-\u0027common-multiple.feature\u0027",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "duration": 2982381,
              "status": "passed"
            },
            "line": 23,
            "name": "path \u0027headers\u0027, token",
            "match": {
              "arguments": [
                {
                  "val": "\u0027headers\u0027, token",
                  "offset": 5
                }
              ],
              "location": "StepDefs.path(String\u003e)"
            },
            "keyword": "Given "
          },
          {
            "result": {
              "duration": 90754,
              "status": "passed"
            },
            "line": 24,
            "name": "param url \u003d demoBaseUrl",
            "match": {
              "arguments": [
                {
                  "val": "url",
                  "offset": 6
                },
                {
                  "val": "demoBaseUrl",
                  "offset": 12
                }
              ],
              "location": "StepDefs.param(String,String\u003e)"
            },
            "keyword": "And "
          },
          {
            "result": {
              "duration": 5453083,
              "status": "passed"
            },
            "line": 25,
            "name": "method get",
            "match": {
              "arguments": [
                {
                  "val": "get",
                  "offset": 7
                }
              ],
              "location": "StepDefs.method(String)"
            },
            "keyword": "When ",
            "doc_string": {
              "content_type": "",
              "line": 25,
              "value": "13:17:33.693 request:\n1 \u003e GET http://127.0.0.1:58351/headers/c7355b63-23a6-4e39-a1d2-741f31d5139f?url\u003dhttp%3A%2F%2F127.0.0.1%3A58351\n1 \u003e Accept-Encoding: gzip,deflate\n1 \u003e Authorization: c7355b63-23a6-4e39-a1d2-741f31d5139f1537428753666http://127.0.0.1:58351\n1 \u003e Connection: Keep-Alive\n1 \u003e Cookie: time\u003d1537428753666\n1 \u003e Host: 127.0.0.1:58351\n1 \u003e User-Agent: Apache-HttpClient/4.5.5 (Java/1.8.0_162)\n1 \u003e request_id: 85b84d97-f998-431b-b86f-f883dd25a5e6\n\n13:17:33.696 response time in milliseconds: 3\n1 \u003c 200\n1 \u003c Cache-Control: no-cache, no-store, max-age\u003d0, must-revalidate\n1 \u003c Content-Length: 0\n1 \u003c Date: Thu, 20 Sep 2018 07:32:33 GMT\n1 \u003c Expires: 0\n1 \u003c Pragma: no-cache\n1 \u003c X-Content-Type-Options: nosniff\n1 \u003c X-Frame-Options: DENY\n1 \u003c X-XSS-Protection: 1; mode\u003dblock\n\n"
            }
          },
          {
            "result": {
              "duration": 57123,
              "status": "passed"
            },
            "line": 26,
            "name": "status 200",
            "match": {
              "arguments": [
                {
                  "val": "200",
                  "offset": 7
                }
              ],
              "location": "StepDefs.status(int)"
            },
            "keyword": "Then "
          }
        ]
      },
      {
        "line": 5,
        "name": "",
        "description": "",
        "type": "background",
        "keyword": "Background",
        "steps": [
          {
            "result": {
              "duration": 3709261,
              "status": "passed"
            },
            "comments": [
              {
                "line": 6,
                "value": "# note how this next line has to be duplicated in \u0027common-multiple.feature\u0027"
              }
            ],
            "line": 7,
            "name": "configure headers \u003d read(\u0027classpath:headers.js\u0027)",
            "match": {
              "arguments": [
                {
                  "val": "headers",
                  "offset": 10
                },
                {
                  "val": "read(\u0027classpath:headers.js\u0027)",
                  "offset": 20
                }
              ],
              "location": "StepDefs.configure(String,String)"
            },
            "keyword": "* "
          },
          {
            "result": {
              "duration": 202634,
              "status": "passed"
            },
            "line": 9,
            "name": "def setup \u003d callonce read(\u0027common-multiple.feature\u0027)",
            "match": {
              "arguments": [
                {
                  "val": "setup",
                  "offset": 4
                },
                {
                  "val": "callonce read(\u0027common-multiple.feature\u0027)",
                  "offset": 12
                }
              ],
              "location": "StepDefs.def(String,String)"
            },
            "keyword": "* ",
            "doc_string": {
              "content_type": "",
              "line": 9,
              "value": "13:17:33.701 callonce cache hit for: read(\u0027common-multiple.feature\u0027)\n"
            }
          },
          {
            "result": {
              "duration": 267049,
              "status": "passed"
            },
            "comments": [
              {
                "line": 10,
                "value": "# and we have to ensure the \u0027time\u0027 and \u0027token\u0027 variables are set for \u0027headers.js\u0027 to work"
              }
            ],
            "line": 11,
            "name": "def time \u003d setup.time",
            "match": {
              "arguments": [
                {
                  "val": "time",
                  "offset": 4
                },
                {
                  "val": "setup.time",
                  "offset": 11
                }
              ],
              "location": "StepDefs.def(String,String)"
            },
            "keyword": "* "
          },
          {
            "result": {
              "duration": 254966,
              "status": "passed"
            },
            "line": 12,
            "name": "def token \u003d setup.token",
            "match": {
              "arguments": [
                {
                  "val": "token",
                  "offset": 4
                },
                {
                  "val": "setup.token",
                  "offset": 12
                }
              ],
              "location": "StepDefs.def(String,String)"
            },
            "keyword": "* "
          },
          {
            "result": {
              "duration": 1484236,
              "status": "passed"
            },
            "comments": [
              {
                "line": 14,
                "value": "# a cookie is also needed in our authentication demo example"
              }
            ],
            "line": 15,
            "name": "cookie time \u003d setup.time",
            "match": {
              "arguments": [
                {
                  "val": "time",
                  "offset": 7
                },
                {
                  "val": "setup.time",
                  "offset": 14
                }
              ],
              "location": "StepDefs.cookie(String,String)"
            },
            "keyword": "* "
          },
          {
            "result": {
              "duration": 27650,
              "status": "passed"
            },
            "comments": [
              {
                "line": 17,
                "value": "# for an example of using \u0027shared scope\u0027 which simplifies the above"
              },
              {
                "line": 18,
                "value": "# refer to \u0027call-updates-config.feature\u0027 and \u0027common.feature\u0027"
              }
            ],
            "line": 20,
            "name": "url demoBaseUrl",
            "match": {
              "arguments": [
                {
                  "val": "demoBaseUrl",
                  "offset": 4
                }
              ],
              "location": "StepDefs.url(String)"
            },
            "keyword": "* "
          }
        ]
      },
      {
        "line": 28,
        "name": "make sure that the second scenario also works well with the \u0027callonce\u0027 in the background",
        "description": "",
        "id": "when-not-using-\u0027shared-scope\u0027,-\u0027configure-headers\u0027-may-need-to-be;make-sure-that-the-second-scenario-also-works-well-with-the-\u0027callonce\u0027-in-the-background",
        "type": "scenario",
        "keyword": "Scenario",
        "steps": [
          {
            "result": {
              "duration": 144684,
              "status": "passed"
            },
            "line": 29,
            "name": "path \u0027headers\u0027, token",
            "match": {
              "arguments": [
                {
                  "val": "\u0027headers\u0027, token",
                  "offset": 5
                }
              ],
              "location": "StepDefs.path(String\u003e)"
            },
            "keyword": "Given "
          },
          {
            "result": {
              "duration": 46268,
              "status": "passed"
            },
            "line": 30,
            "name": "param url \u003d demoBaseUrl",
            "match": {
              "arguments": [
                {
                  "val": "url",
                  "offset": 6
                },
                {
                  "val": "demoBaseUrl",
                  "offset": 12
                }
              ],
              "location": "StepDefs.param(String,String\u003e)"
            },
            "keyword": "And "
          },
          {
            "result": {
              "duration": 4904062,
              "status": "passed"
            },
            "line": 31,
            "name": "method get",
            "match": {
              "arguments": [
                {
                  "val": "get",
                  "offset": 7
                }
              ],
              "location": "StepDefs.method(String)"
            },
            "keyword": "When ",
            "doc_string": {
              "content_type": "",
              "line": 31,
              "value": "13:17:33.707 request:\n1 \u003e GET http://127.0.0.1:58351/headers/c7355b63-23a6-4e39-a1d2-741f31d5139f?url\u003dhttp%3A%2F%2F127.0.0.1%3A58351\n1 \u003e Accept-Encoding: gzip,deflate\n1 \u003e Authorization: c7355b63-23a6-4e39-a1d2-741f31d5139f1537428753666http://127.0.0.1:58351\n1 \u003e Connection: Keep-Alive\n1 \u003e Cookie: time\u003d1537428753666\n1 \u003e Host: 127.0.0.1:58351\n1 \u003e User-Agent: Apache-HttpClient/4.5.5 (Java/1.8.0_162)\n1 \u003e request_id: 733b4682-ca59-4a4f-b81f-2215428bb629\n\n13:17:33.709 response time in milliseconds: 2\n1 \u003c 200\n1 \u003c Cache-Control: no-cache, no-store, max-age\u003d0, must-revalidate\n1 \u003c Content-Length: 0\n1 \u003c Date: Thu, 20 Sep 2018 07:32:33 GMT\n1 \u003c Expires: 0\n1 \u003c Pragma: no-cache\n1 \u003c X-Content-Type-Options: nosniff\n1 \u003c X-Frame-Options: DENY\n1 \u003c X-XSS-Protection: 1; mode\u003dblock\n\n"
            }
          },
          {
            "result": {
              "duration": 67404,
              "status": "passed"
            },
            "line": 32,
            "name": "status 200",
            "match": {
              "arguments": [
                {
                  "val": "200",
                  "offset": 7
                }
              ],
              "location": "StepDefs.status(int)"
            },
            "keyword": "Then "
          }
        ]
      }
    ],
    "name": "demo/headers/call-isolated-headers.feature",
    "description": "when not using \u0027shared scope\u0027, \u0027configure headers\u0027 may need to be\nduplicated even in \u0027called\u0027 features and the variables needed for the\n  headers JS routine should be returned and made available to the \u0027caller\u0027",
    "id": "when-not-using-\u0027shared-scope\u0027,-\u0027configure-headers\u0027-may-need-to-be",
    "keyword": "Feature",
    "uri": "demo/headers/call-isolated-headers.feature"
  }
]