13:17:33.659 karate.get failed for expression: 'token': javascript evaluation failed: token, ReferenceError: "token" is not defined in <eval> at line number 1
13:17:33.661 karate.get failed for expression: 'time': javascript evaluation failed: time, ReferenceError: "time" is not defined in <eval> at line number 1
13:17:33.662 request:
1 > GET http://127.0.0.1:58351/headers
1 > Accept-Encoding: gzip,deflate
1 > Connection: Keep-Alive
1 > Host: 127.0.0.1:58351
1 > User-Agent: Apache-HttpClient/4.5.5 (Java/1.8.0_162)

13:17:33.668 response time in milliseconds: 5
1 < 200
1 < Cache-Control: no-cache, no-store, max-age=0, must-revalidate
1 < Content-Length: 36
1 < Content-Type: text/plain;charset=UTF-8
1 < Date: Thu, 20 Sep 2018 07:32:33 GMT
1 < Expires: 0
1 < Pragma: no-cache
1 < Set-Cookie: time=1537428753666
1 < X-Content-Type-Options: nosniff
1 < X-Frame-Options: DENY
1 < X-XSS-Protection: 1; mode=block
c7355b63-23a6-4e39-a1d2-741f31d5139f

13:17:33.679 request:
2 > GET http://127.0.0.1:58351/headers/c7355b63-23a6-4e39-a1d2-741f31d5139f?url=http%3A%2F%2F127.0.0.1%3A58351
2 > Accept-Encoding: gzip,deflate
2 > Authorization: c7355b63-23a6-4e39-a1d2-741f31d5139f1537428753666http://127.0.0.1:58351
2 > Connection: Keep-Alive
2 > Cookie: time=1537428753666
2 > Host: 127.0.0.1:58351
2 > User-Agent: Apache-HttpClient/4.5.5 (Java/1.8.0_162)
2 > request_id: 152225c7-26ea-4250-af0a-bb1c40070ebd

13:17:33.682 response time in milliseconds: 2
2 < 200
2 < Cache-Control: no-cache, no-store, max-age=0, must-revalidate
2 < Content-Length: 0
2 < Date: Thu, 20 Sep 2018 07:32:33 GMT
2 < Expires: 0
2 < Pragma: no-cache
2 < X-Content-Type-Options: nosniff
2 < X-Frame-Options: DENY
2 < X-XSS-Protection: 1; mode=block

13:17:33.683 cached callonce: read('common-multiple.feature')
13:17:33.693 request:
1 > GET http://127.0.0.1:58351/headers/c7355b63-23a6-4e39-a1d2-741f31d5139f?url=http%3A%2F%2F127.0.0.1%3A58351
1 > Accept-Encoding: gzip,deflate
1 > Authorization: c7355b63-23a6-4e39-a1d2-741f31d5139f1537428753666http://127.0.0.1:58351
1 > Connection: Keep-Alive
1 > Cookie: time=1537428753666
1 > Host: 127.0.0.1:58351
1 > User-Agent: Apache-HttpClient/4.5.5 (Java/1.8.0_162)
1 > request_id: 85b84d97-f998-431b-b86f-f883dd25a5e6

13:17:33.696 response time in milliseconds: 3
1 < 200
1 < Cache-Control: no-cache, no-store, max-age=0, must-revalidate
1 < Content-Length: 0
1 < Date: Thu, 20 Sep 2018 07:32:33 GMT
1 < Expires: 0
1 < Pragma: no-cache
1 < X-Content-Type-Options: nosniff
1 < X-Frame-Options: DENY
1 < X-XSS-Protection: 1; mode=block

13:17:33.701 callonce cache hit for: read('common-multiple.feature')
13:17:33.707 request:
1 > GET http://127.0.0.1:58351/headers/c7355b63-23a6-4e39-a1d2-741f31d5139f?url=http%3A%2F%2F127.0.0.1%3A58351
1 > Accept-Encoding: gzip,deflate
1 > Authorization: c7355b63-23a6-4e39-a1d2-741f31d5139f1537428753666http://127.0.0.1:58351
1 > Connection: Keep-Alive
1 > Cookie: time=1537428753666
1 > Host: 127.0.0.1:58351
1 > User-Agent: Apache-HttpClient/4.5.5 (Java/1.8.0_162)
1 > request_id: 733b4682-ca59-4a4f-b81f-2215428bb629

13:17:33.709 response time in milliseconds: 2
1 < 200
1 < Cache-Control: no-cache, no-store, max-age=0, must-revalidate
1 < Content-Length: 0
1 < Date: Thu, 20 Sep 2018 07:32:33 GMT
1 < Expires: 0
1 < Pragma: no-cache
1 < X-Content-Type-Options: nosniff
1 < X-Frame-Options: DENY
1 < X-XSS-Protection: 1; mode=block

ure('readTimeout', 5000);  
  var port = karate.properties['demo.server.port'];  
  if (!port) {
    port = karate.env == 'web' ? 8090 : 8080;
  }
  var protocol = 'http';
  if (karate.properties['demo.server.https'] == 'true') {
    protocol = 'https';
    karate.configure('ssl', true);
  }  
  var config = { demoBaseUrl: protocol + '://127.0.0.1:' + port };
  if (karate.env == 'proxy') {
    var proxyPort = karate.properties['demo.proxy.port']
    karate.configure('proxy', 'http://127.0.0.1:' + proxyPort);
  }
  if (karate.env != 'mock' && karate.env != 'proxy' && karate.env != 'contract') {
    // 'callSingle' is guaranteed to run only once even across all threads
    var result = karate.callSingle('classpath:demo/headers/common-noheaders.feature', config);
    // and it sets a variable called 'authInfo' used in headers-single.feature
    config.authInfo = { authTime: result.time, authToken: result.token };
  }
  return config;
}
